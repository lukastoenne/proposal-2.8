

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Pipelines, Linking, Proxies, and Overrides &mdash; proposal-2.8 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="proposal-2.8 1.0 documentation" href="index.html"/>
        <link rel="next" title="Object Nodes" href="object_nodes.html"/>
        <link rel="prev" title="Proposal for Caching, Nodes and Physics Development in Blender 2.8" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> proposal-2.8
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Pipelines, Linking, Proxies, and Overrides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#typical-rigger-animator-workflow-with-proxies-using-the-example-of-simple-character">Typical rigger+animator workflow with proxies using the example of [simple character]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simple-non-dynamic-hair-setup-as-used-for-coro-the-main-character-in-caminandes">Simple non-dynamic hair setup as used for Coro, the main character in Caminandes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamic-hair-sim-victor-or-franck-hair-shot">Dynamic hair sim [Victor or Franck hair shot]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#animation-offsets-for-simple-variation">Animation Offsets for Simple Variation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#animation-variants-multiple-sheep-in-tornado-shot-or-penguins-in-caminandes-3">Animation Variants [multiple sheep in tornado shot OR penguins in Caminandes 3]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#material-lighting-py-overrides-in-local-scene">Material/Lighting py overrides in local scene</a></li>
<li class="toctree-l2"><a class="reference internal" href="#recap">Recap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="object_nodes.html">Object Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="caching.html">Unified caching API</a></li>
<li class="toctree-l1"><a class="reference internal" href="fracture.html">Fracture Simulation Workflow with Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">Overview and ToDo list of topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">proposal-2.8</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Pipelines, Linking, Proxies, and Overrides</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/pipeline.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pipelines-linking-proxies-and-overrides">
<h1>Pipelines, Linking, Proxies, and Overrides<a class="headerlink" href="#pipelines-linking-proxies-and-overrides" title="Permalink to this headline">¶</a></h1>
<div class="section" id="typical-rigger-animator-workflow-with-proxies-using-the-example-of-simple-character">
<h2>Typical rigger+animator workflow with proxies using the example of [simple character]<a class="headerlink" href="#typical-rigger-animator-workflow-with-proxies-using-the-example-of-simple-character" title="Permalink to this headline">¶</a></h2>
<p>[This should be as simple as possible: no hair/fur, simple rig (no spline ik), perhaps a non-character rig?]</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure" id="id1">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">1. Base mesh</span></p>
</div>
</td>
<td><div class="first last figure" id="id2">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">2. Rigging</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last figure" id="id3">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">3. Linking mesh &amp; rig</span></p>
</div>
</td>
<td><div class="first last figure" id="id4">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">4. Linked pose is locked!</span></p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last figure" id="id5">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">5. Proxy armature</span></p>
</div>
</td>
<td><div class="first last figure" id="id6">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">6. Lighting/Render scene</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li>[show basic mesh object during modeling process in the viewport]
&#8220;Modeler Molly creates a Mesh object, models, sculpts and textures it. Everything is local here since we&#8217;re at the very beginning of the pipeline.&#8221;</li>
<li>[show rig bones in viewport]
&#8220;Rigger Ricky links in the mesh object from Molly. Then he adds a new Armature object. His main work is creating bones in the armature and then adding constraints to the pose bones for control during animation.&#8221;</li>
<li>[show link dialog for mesh object]
&#8220;Animator Annie links in both the mesh object from Molly and the Armature object from Ricky. The armature object can be linked indirectly through the mesh object.&#8221;</li>
<li>[show immovable pose bones (how? greyed out panel?)]
&#8220;Annie now wants to animate by moving the pose bones in the armature object. But she has a problem: the armature object is linked, so the pose bones can not be moved by her. In pipeline terms: the pose bones are ‘owned’ by Ricky because he first created the object.&#8221;</li>
<li>[show deformed rig in viewport after moving a proxy pose bone]
&#8220;Annie therefore creates a &#8216;proxy&#8217; for the linked armature object. This is a local object, so she can move the pose bones there, and they override the linked object.&#8221;</li>
<li>[show final render scene viewport with the object linked in]
“When all the animation for a shot is completed, Lisa the lighting TD creates a new file for the final rendering. All the assets are also linked into that file, so that fixes can still be made if necessary. Also importantly any linked objects are instanced as groups rather than used directly, which allows Lisa to move them around.”</li>
</ol>
</div>
<div class="section" id="simple-non-dynamic-hair-setup-as-used-for-coro-the-main-character-in-caminandes">
<h2>Simple non-dynamic hair setup as used for Coro, the main character in Caminandes<a class="headerlink" href="#simple-non-dynamic-hair-setup-as-used-for-coro-the-main-character-in-caminandes" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure" id="id7">
<a class="reference internal image-reference" href="_images/koro_modeling.png"><img alt="_images/koro_modeling.png" src="_images/koro_modeling.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">1. Base mesh</span></p>
</div>
</td>
<td><div class="first last figure" id="id8">
<a class="reference internal image-reference" href="_images/koro_grooming.png"><img alt="_images/koro_grooming.png" src="_images/koro_grooming.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">2. Grooming</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last figure" id="id9">
<a class="reference internal image-reference" href="_images/koro_rigging.png"><img alt="_images/koro_rigging.png" src="_images/koro_rigging.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">3. Rigging</span></p>
</div>
</td>
<td><div class="first last figure" id="id10">
<a class="reference internal image-reference" href="_images/koro_animation.png"><img alt="_images/koro_animation.png" src="_images/koro_animation.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">4. Animation</span></p>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last figure" id="id11">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">5. Lighting</span></p>
</div>
</td>
<td><div class="first last figure" id="id12">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">6. Simulation</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<ol class="arabic">
<li><p class="first">[show Coro model without hair]
&#8220;Modeler Molly sets up the mesh object as before.&#8221;</p>
</li>
<li><p class="first">[show Coro hair edit mode during grooming]
&#8220;Hair specialist Harry takes over (appends) the mesh object from Molly. This will work under the assumption that Molly doesn’t need to touch the Object datablock any longer, because she works with Mesh datablock instead!</p>
<p>He then adds a hair system to the character. “Grooming” defines the style and look of the character. Note that linking Molly&#8217;s object would be a problem, because then he couldn&#8217;t add a hair system to it. Editing conflict is avoided here only by passing mesh object ownership from Ricky to Harry before animation!&#8221;</p>
</li>
<li><p class="first">[show Coro rig]
&#8220;Rigger Ricky now continues by linking the object with hair from Harry (rather than directly using Molly’s mesh object).&#8221;</p>
</li>
<li><p class="first">[show Coro pose with deformed hair]
&#8220;Annie continues as before by making a proxy object for the armature and animating its pose bones. She doesn&#8217;t have to animate the hair itself, but it helps her to have it visible during animation[1].”</p>
</li>
<li><p class="first">“Lisa also can use the object with hair as she did before. The hair displacement from mesh surface deformation (the “scalp”) is calculated automatically as the proxy pose defines the animation.”</p>
</li>
</ol>
</div>
<div class="section" id="dynamic-hair-sim-victor-or-franck-hair-shot">
<h2>Dynamic hair sim [Victor or Franck hair shot]<a class="headerlink" href="#dynamic-hair-sim-victor-or-franck-hair-shot" title="Permalink to this headline">¶</a></h2>
<p>Serious trouble ensues because of linked objects after animation.</p>
<blockquote>
<div>&#8220;Steps 1-4 happen as before: model, groom, rig, animate, and setup the complete render scene.”</div></blockquote>
<ol class="arabic simple" start="5">
<li>&#8220;Simulation specialist Simon now has to simulate motion of Harry&#8217;s hair strands. Long hair has to move in the wind and collide with the character&#8217;s body. But Simon has a problem similar to the one Annie had before: the object with the hair system is linked and he cannot add or tweak a simulation on it[2]. Simon has a few options now:
1. He can make the whole mesh object local in his file. Then he could modify the simulation settings, but any changes by Molly to her model would not end up in his file any more. He would have to painstakingly merge .blend files every time this happens, which is why linking was implemented in the first place!
2. He can directly edit Molly&#8217;s model file where the hair system is local. But this is dangerous because his changes would conflict with potential changes by Molly (it just moves the burden of merging changes back to Molly). He also still has to bake the simulation in his own file so that Annie’s animation is used correctly for hair physics.”</li>
<li>“Now Lisa has to import the object with simulated hair from Simon. Assuming Simon made a local object copy to avoid the linking issues, Lisa then has to link Simon’s rather than Ricky’s object.”</li>
</ol>
</div>
<div class="section" id="animation-offsets-for-simple-variation">
<h2>Animation Offsets for Simple Variation<a class="headerlink" href="#animation-offsets-for-simple-variation" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><div class="first last figure" id="id13">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">1. Single Penguin</span></p>
</div>
</td>
<td><div class="first last figure" id="id14">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">2. Identical Instances</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last figure" id="id15">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">3. Offset with NLA</span></p>
</div>
</td>
<td><div class="first last figure" id="id16">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">4. Offset with Mesh Cache</span></p>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last figure" id="id17">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">5. Final Crowd Shot</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p>In “Caminandes: Llamigos” the final shot contains a group of penguins. A cheap way to avoid repetitive animation is needed.</p>
<p>A detailed description of the technique can be found on the Blender Cloud: <a class="reference external" href="https://cloud.blender.org/p/caminandes-3/#56bc8f68c379cf0079715f85">Quick Penguin Crowds using MDD caches</a></p>
<ol class="arabic simple">
<li>Molly, Ricky and Annie create a single animated penguin as outlined before.</li>
<li>Now Lisa can link in the animated penguin and create a large number of instances. However, all of these instances share the same object and animation, so they move in perfect sync. To make the shot believable she wants to offset each penguin’s action so that they look like different characters (at least for a simple, short background sequence).</li>
<li>To do this Lisa could employ the NLA editor to offset the actions. But this is not a suitable tool when the objects are linked. Furthermore the NLA still relies on evaluation of armatures for producing the deformation, which become prohibitively slow for multiple characters.</li>
<li>A better solution is the use of the mesh cache modifier. After exporting the animation into a MDD file (which stores just deformation) Lisa can create a plain copy of the penguin and replace all rigging and animation modifiers with a single cache import. The mesh cache modifier allows offsetting and remapping the animation in a very simple and straightforward way.</li>
<li>Lisa can now create multiple different penguins simply by making several copies of the original. Even though these are local copies, rather than linked instances, animation fixes will still be imported via the shared cache.</li>
</ol>
</div>
<div class="section" id="animation-variants-multiple-sheep-in-tornado-shot-or-penguins-in-caminandes-3">
<h2>Animation Variants [multiple sheep in tornado shot OR penguins in Caminandes 3]<a class="headerlink" href="#animation-variants-multiple-sheep-in-tornado-shot-or-penguins-in-caminandes-3" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2"><div class="first last figure" id="id18">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">1-3. Single Sheep</span></p>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last figure" id="id19">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">2. Single Proxy Limitation</span></p>
</div>
</td>
<td><div class="first last figure" id="id20">
<a class="reference internal image-reference" href="_images/placeholder.png"><img alt="_images/placeholder.png" src="_images/placeholder.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">3. Identical Hair Simulation</span></p>
</div>
</td>
</tr>
</tbody>
</table>
<p>[Override mechanism of proxies does not allow use of multiple animation variants.]</p>
<p>For the Gooseberry tornado shots a flock of sheep has to be grouped around the central character Victor. Many sheep share the same base mesh, rig and hair groom, but fur coats must be simulated individually to account for relative wind direction and differences in sheep bodies (collision).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the final version of the movie a drastically simplified approach was taken. Here is a description of the original more complex idea, for illustration purposes.</p>
</div>
<p>Steps 1-3 are regular modeling, grooming, and rigging as before.</p>
<ol class="arabic simple" start="4">
<li>Annie should animate each sheep individually, but is hampered by the proxy system: Because proxies write back to the original object there can only ever be one single proxy per sheep model, and consequently just one active action for all the instances.</li>
<li>Simon now has to simulate hair motion as before. But in addition to inaccessible linked simulation settings there is a new problem: Even if he managed to tweak the simulation, both the settings and the resulting motion cache would be associated with the original model. Just like Annie he can only use one version of the hair motion at a time.</li>
</ol>
</div>
<div class="section" id="material-lighting-py-overrides-in-local-scene">
<h2>Material/Lighting py overrides in local scene<a class="headerlink" href="#material-lighting-py-overrides-in-local-scene" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Original scene viewport, with local materials</li>
<li>Render/compo scene viewport: linked groups</li>
<li>Change a material/light property -&gt; panel is greyed out!</li>
<li>Make a py script, changing linked objects&#8217; properties</li>
<li>Render/compo scene viewport with changed settings</li>
</ol>
</div>
<div class="section" id="recap">
<h2>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">¶</a></h2>
<p>Linking datablocks is used to allow back-and-forth pipeline work: fixes of a mesh, rig, or material can be done later, even after that datablock is already used by somebody else.</p>
<p>The central problem that arises from linking is that many artists have to work inside the same datablock, especially in the ubiquitous Object blocks:</p>
<ul class="simple">
<li>Ricky&#8217;s armature object also stores the pose bones that Annie needs for animation.</li>
<li>Molly&#8217;s mesh object also stores the hair strands that Harry and Simon need for grooming and hair simulation respectively.</li>
<li>The shader used for a mesh is also defined during mesh modeling and cannot be replaced later, even temporarily, for lighting and final rendering.</li>
</ul>
<p>The &#8220;brute force&#8221; approach to solving these problems is to simply bypass the data lock for linked objects. Python scripts are not limited in the same way as operators and UI buttons, so they can just overwrite linked data. The downside is that none of these changes can be persistent and are lost as soon as you close the file. So any python overrides have to be stored as a script that gets executed every time the file is loaded - hardly a maintainable solution for a large project. In any case, the complexity of most tools, modifiers and simulations makes this method unsuitable for more than quick hacks.</p>
<p>Just making objects local also works, but that completely nullifies the advantages of linking.</p>
<p>Proxies are a step in right direction. They also avoid the persistence problem by making a local object - and then connecting it back to the original! Proxies were designed specifically for animating pose bones, and they work for that case only. Other areas like modifiers, hair simulation, particles etc. cannot use proxies (or only via python drivers for a few key options).</p>
<p>A more fundamental issue of all “override” approaches (proxies and python scripts and caches) is that they work on data which already exists in the linked object! Blender totally lacks any method for combining the content of an existing object with that of a new object. Such an “aggregation” concept could solve both the data lock problems of linked base objects as well as allow “branching out” objects into multiple different variants of animation, simulation, etc.</p>
<p>Caching has been used to implement a kind of limited aggregation actually: After animating a single character it gets cached, then a new object is created locally and “pulls in” the animation via the cache. This is still quite crude and cannot handle anything more than mesh deformation, but it serves the same purpose. More importantly: caching should not be a requirement for extending objects! In a complex pipeline an object would be extended and supplemented many times, and having to manage a cache for every step becomes very cumbersome (as was experienced during Gooseberry production).</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="object_nodes.html" class="btn btn-neutral float-right" title="Object Nodes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Proposal for Caching, Nodes and Physics Development in Blender 2.8" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lukas Tönne.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>